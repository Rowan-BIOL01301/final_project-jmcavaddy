---
title: "Final Project"
subtitle: "Data Science for Biologists, Spring 2021"
author: "John McAvaddy"
output: 
  html_document:
    theme: lumen
    highlight: espresso
editor_options: 
  chunk_output_type: console
---

```{r setup, include=FALSE}
# DON'T CHANGE THE NEXT LINE, except to add NEW options if you have any.
knitr::opts_chunk$set(warning=FALSE, message=FALSE, echo = TRUE, include = TRUE)

# Load all libraries you use HERE:
library(tidyverse)
library(broom)
library(pROC)
```

<br><br>

## Introduction

I chose [data](https://github.com/rfordatascience/tidytuesday/tree/master/data/2020/2020-09-22) recorded on mountain ascents in the [Himalayan mountain range](https://en.wikipedia.org/wiki/Himalayas). I chose this data because if I could get paid to climb mountains, I would climb one every day for the rest of my life. Because of my love for climbing mountains, I thought it would be interesting to explore climbing data collected from some of the [tallest mountains](https://en.wikipedia.org/wiki/List_of_highest_mountains_on_Earth) in the world. 

```{r read-examine-data}
members <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-22/members.csv')
expeditions <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-22/expeditions.csv')
peaks <- readr::read_csv('https://raw.githubusercontent.com/rfordatascience/tidytuesday/master/data/2020/2020-09-22/peaks.csv')

glimpse(members) # see data in members data set
glimpse(expeditions) # see data in expeditions data set
glimpse(peaks) # see data in peaks data set
```

<br><br>

## Question 1

#### How well does the average age of an expedition group predict whether the group successfully reached a peak?

### Methods
```{r question_one_wrangling}
# create a column of expedition group's average age
members %>%
  group_by(expedition_id) %>% # groups rows by similar values in
  summarize(average_age = mean(age)) %>% # create new column of average ages of each expedition group
  drop_na() %>% # drop NA here so I don't consider any groups that do not have a "complete" average age
  left_join(members) -> # combine average_age column into original data set
  members_avg_age

# turn termination_reason column into "success" or "failure"
expeditions %>%
  mutate(termination_reason_chr = if_else(str_detect(termination_reason, "Success"),
                                          "Success",
                                          "Failure")) %>%
  mutate(termination_reason_01 = if_else(termination_reason_chr == "Success",
                                         1,
                                         0)) %>%
  select(termination_reason_01, termination_reason_chr, expedition_id) -> 
  expd_success_chr_01

# bring together and clean tables with average ages and termination reasons
expd_success_chr_01 %>%
  left_join(members_avg_age) %>%
  select(expedition_id, average_age, termination_reason_chr, termination_reason_01) %>%
  distinct() %>%
  drop_na() -> expd_success_avg_age


```

```{r question_one_model}
# building a model using success as response and average age as predictor
age_model <- glm(termination_reason_chr ~ average_age, data = expd_success_avg_age, family = "binomial")

tidy(age_model)


```

```{r question_one_plotting}
```
### Answer

Replace this text with your answer to your question.


<br><br>

## Question 2

#### Are injuries more likely to occur in the upper half or lower half of the peak's height?
### Methods

### Answer

Replace this text with your answer to your question.

<br><br>

## Question 3

#### In which season are climbers most likely to succeed?

### Methods

### Answer

Replace this text with your answer to your question.


<br><br>

## Question 4

#### Which peak had the youngest average age of the first expedition to its peak?

### Methods

### Answer

Replace this text with your answer to your question.
